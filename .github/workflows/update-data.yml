name: Automated Data Fetch and Update

on:
  # (6) Configure recurring schedule: run every Monday at 00:00 UTC
  schedule:
    - cron: '0 0 * * 1'
  # Allow manual trigger via GitHub Actions interface
  workflow_dispatch:

jobs:
  update-research-data:
    # Note: GitHub Actions runs on Linux (ubuntu-latest), not macOS
    runs-on: ubuntu-latest

    steps:
    # 1. Checkout the repository code
    - name: Checkout repository
      uses: actions/checkout@v4

    # 2. Set up Python environment
 
- name: Set up Python
  uses: actions/setup-python@v5
  with:
    # Pinned to 3.10 to ensure the deprecated 'cgi' module is available
    python-version: '3.10' 

    # 3. Install Python dependencies
    - name: Install dependencies
      # We use python3 for consistency
      run: python3 -m pip install -r requirements.txt

    # 4. (6) Run the Data Acquisition and Processing script
    - name: Run data acquisition script
      run: python3 script.py

    # 5. Commit and push the updated data file
    - name: Commit and Push new data
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        # Only commit the data file
        commit_files: data/research.json
        commit_message: "Automated Data Update: Fetch latest Sulforaphane research"
